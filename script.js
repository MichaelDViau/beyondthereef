const translations = {
  en: {
    global: {
      'nav.primary': 'Primary',
      'nav.toggle': 'Toggle navigation',
      'nav.home': 'Home',
      'nav.create': 'Excursions',
      'nav.reviews': 'Reviews',
      'nav.story': 'Our Story',
      'footer.rights': 'Beyond the Reef Mexico. All rights reserved.',
      'floatingContact.aria': 'Quick contact options',
      'floatingContact.whatsappAria': 'Chat on WhatsApp',
      'floatingContact.emailAria': 'Email Beyond the Reef Mexico',
      'floatingContact.instagramAria': 'Open Instagram',
      'floatingContact.whatsappLabel': 'WhatsApp',
      'floatingContact.emailLabel': 'Email',
      'floatingContact.instagramLabel': 'Instagram',
      'themeToggle.dark': 'Dark mode',
      'themeToggle.light': 'Light mode',
      'heroSlider.goToSlide': 'Go to slide {{index}}',
      'tourBuilder.remove': 'Remove'
    },
    home: {
      'page.title': 'Beyond the Reef Mexico',
      'home.hero.aria': 'Featured Experiences',
      'home.hero.heading': 'Pure adrenaline. Untamed nature. Your story in the making.',
      'home.hero.description':
        'Not just a day out - this is freedom unleashed. Swim with turtles, dive into cenotes, race across lagoons, and explore ancient Mayan ruins. No crowds. No limits. Just raw adventure carved into the heart of the Riviera Maya. Your rules. Your pace. Your unforgettable. This isn‚Äôt tourism. This is Beyond the Reef.',
      'home.hero.previous': 'Previous slide',
      'home.hero.next': 'Next slide',
      'home.hero.dots': 'Featured slides',
      'home.difference.heading': 'Experience the Difference',
      'home.difference.captured.title': 'Captured',
      'home.difference.captured.copy': 'Complimentary Photography on Every Tour',
      'home.difference.pace.title': 'Set the Pace',
      'home.difference.pace.copy': 'Choose your start time, skip pickups, set your own schedule',
      'home.difference.journey.title': 'Your Journey',
      'home.difference.journey.copy': 'Snorkel, explore, taste, relax - the choice is yours',
      'home.difference.surprises.title': 'No Surprises',
      'home.difference.surprises.copy': 'No hidden costs, No extra charges, Just adventure',
      'home.difference.excellence.title': 'Excellence',
      'home.difference.excellence.copy': 'We don‚Äôt claim it - our guests do. Five stars, every time.',
      'home.favorites.heading': 'Adventures Loved by Travelers',
      'home.favorites.copy': 'Swipe through limited-time offers on the tours our guests love the most.',
      'home.favorites.previous': 'Previous tours',
      'home.favorites.next': 'Next tours',
      'home.favorites.card1.tag': 'Top pick',
      'home.favorites.card1.title': 'Swimming with Whale Sharks',
      'home.favorites.card1.badge': '-30%',
      'home.favorites.card1.deal': 'Up to 30% discount',
      'home.favorites.card1.copy':
        'Charter a private boat with marine biologist guides and slip into the water beside gentle giants at sunrise.',
      'home.favorites.card1.cta': 'More information',
      'home.favorites.card2.tag': 'Guest favorite',
      'home.favorites.card2.title': 'The Taco Tour',
      'home.favorites.card2.badge': '-25%',
      'home.favorites.card2.deal': 'Up to 25% discount',
      'home.favorites.card2.copy':
        'Taste your way through hidden taquer√≠as with a local host curating mezcal pairings and street-food legends.',
      'home.favorites.card2.cta': 'More information',
      'home.favorites.card3.tag': 'Limited spots',
      'home.favorites.card3.title': 'El Cielo Cozumel Snorkeling',
      'home.favorites.card3.badge': '-22%',
      'home.favorites.card3.deal': 'Up to 22% discount',
      'home.favorites.card3.copy':
        'Float above starfish gardens and neon reefs in Cozumel with a captain who times the sandbar at its clearest.',
      'home.favorites.card3.cta': 'More information',
      'home.favorites.card4.tag': 'Photo ready',
      'home.favorites.card4.title': 'Tulum Insta Experience',
      'home.favorites.card4.badge': '-18%',
      'home.favorites.card4.deal': 'Up to 18% discount',
      'home.favorites.card4.copy':
        'Capture cinematic shots across Tulum‚Äôs ruins and cenotes with a creative director setting the scene for every moment.',
      'home.favorites.card4.cta': 'More information',
      'home.builder.eyebrow': 'Plan with our concierge team',
      'home.builder.heading': 'We build your perfect day',
      'home.builder.copy':
        'Share your idea by email and receive a personalized quote, or book a video call with our team to fine-tune every detail.',
      'home.builder.formAria': 'Send your perfect day details',
      'home.builder.nameLabel': 'Name',
      'home.builder.namePlaceholder': 'Your name',
      'home.builder.emailLabel': 'Email',
      'home.builder.emailPlaceholder': 'you@example.com',
      'home.builder.phoneLabel': 'Phone',
      'home.builder.phonePlaceholder': '+52 1 555 555 5555',
      'home.builder.notesLabel': 'Tell us about your idea',
      'home.builder.notesPlaceholder': 'Include the date, vibe, and any must-do experiences.',
      'home.builder.submit': 'Send my idea',
      'home.builder.listHeading': 'Tell us about your dream day',
      'home.builder.pointOne': 'Share the vibe you want: relaxed, high-energy, romantic, or off-grid.',
      'home.builder.pointTwo': 'Add any must-do activities, dining styles, or timing preferences.',
      'home.builder.pointThree':
        'You‚Äôll receive a personalized quote or the option to connect with our team by video call.',
      'home.builder.emailFallback':
        'Prefer email? Reach us directly at <a href="mailto:info@beyondthereefmexico.com">info@beyondthereefmexico.com</a>.',
      'home.builder.emailSubject': 'Custom day idea from {{name}}',
      'home.builder.status.missing': 'Please add your name, email, and idea so we can craft your quote.',
      'home.builder.status.prompt': 'Opening your email app to send the details to our concierge.',
      'home.accent.eyebrow': 'Why travelers love us',
      'home.accent.heading': 'Private, Stress-Free Excursions',
      'home.accent.locals.title': 'Led by certified guides',
      'home.accent.locals.copy':
        'Our certified guides bring years of professional experience, crafting insider-only moments you cannot find on a brochure.',
      'home.accent.collab.title': 'Can‚Äôt find the tour you want?',
      'home.accent.collab.copy':
        'Reach out and we‚Äôll schedule a call or video chat to custom-build your perfect excursions.',
      'home.accent.execution.title': 'Worry-free tours',
      'home.accent.execution.copy':
        'Your tour, your time, no hidden fees, with transfers, tickets, and timing handled so you just enjoy.',
      'home.cta.heading': 'Ready to build your dream tour?',
      'home.cta.copy': 'Reach out and we‚Äôll design the right experience for you.',
      'home.cta.button': 'Email us now'
    },
    tours: {
      'page.title': 'Excursions & Private Tours | Beyond the Reef Mexico',
      'tours.hero.eyebrow': 'Build your tour',
      'tours.hero.heading': 'Design experiences as unique as your crew',
      'tours.hero.copy':
        'Drag and drop curated activities, refine pacing, and invite your travel companions to collaborate in real time.',
      'tours.grid.custom.title': 'Custom combinations',
      'tours.grid.custom.copy':
        'Mix scuba dives, culinary surprises, and remote hikes across islands. Our smart planner orchestrates logistics so you can focus on the fun.',
      'tours.grid.pacing.title': 'Smart pacing',
      'tours.grid.pacing.copy':
        'We balance high-energy adventures with restorative interludes, ensuring every guest has time to recharge.',
      'tours.grid.collab.title': 'Co-create instantly',
      'tours.grid.collab.copy':
        'Share a private link so your crew can vote, comment, or add new ideas. Our concierges can jump in live to fine-tune.',
      'tours.steps.heading': 'How the custom builder works',
      'tours.steps.one.title': 'Tell us about your dream',
      'tours.steps.one.copy': 'Answer a few questions or import a mood board. We use your vibe to pre-select experiences.',
      'tours.steps.two.title': 'Remix the plan',
      'tours.steps.two.copy':
        'Drag items between days, adjust timing, and add bespoke requests like photographers or private chefs.',
      'tours.steps.three.title': 'Lock it in',
      'tours.steps.three.copy':
        'Collaborate with your concierge to finalize transfers, payments, and on-island support.'
    },
    reviews: {
      'page.title': 'Guest Reviews | Beyond the Reef Mexico',
      'reviews.hero.eyebrow': 'Guest love letters',
      'reviews.hero.heading': 'Stories from travelers who went beyond',
      'reviews.hero.copy':
        'Hear how custom-crafted journeys and thoughtful touches turned bucket-list dreams into effortless escapes.',
      'reviews.featured.heading': 'Featured reviews',
      'reviews.featured.one.title': '‚ÄúThey thought of every detail.‚Äù',
      'reviews.featured.one.copy':
        '‚ÄúFrom the midnight manta ray swim to the surprise anniversary dinner on a sandbar, the Beyond the Reef team went above and beyond. We never looked at our watches once.‚Äù - <strong>Cam &amp; Jordan</strong>',
      'reviews.featured.two.title': '‚ÄúPlanning was actually fun.‚Äù',
      'reviews.featured.two.copy':
        '‚ÄúWe built the itinerary together during a video call and could see availability update live. Their concierge secured a private guide for my dad so he could explore at his own pace.‚Äù - <strong>Riya</strong>',
      'reviews.featured.three.title': '‚ÄúOur friends are still raving.‚Äù',
      'reviews.featured.three.copy':
        '‚ÄúThe group chat was blowing up with ideas. The Beyond the Reef planner kept everything organized and even added mixology classes based on our Spotify playlist.‚Äù - <strong>Diego &amp; crew</strong>',
      'reviews.share.heading': 'Share your experience',
      'reviews.share.copy':
        'Email <a href="mailto:info@beyondthereefmexico.com">info@beyondthereefmexico.com</a> with a highlight reel or tag us on social with <strong>#BeyondTheReef</strong> for a chance to be featured.'
    },
    story: {
      'page.title': 'Our Story | Beyond the Reef Mexico',
      'story.hero.eyebrow': 'Our story',
      'story.hero.heading': 'Born from a love of the sea and storytelling',
      'story.hero.copy':
        'Every experience is thoughtfully designed to feel personal, seamless, and genuinely human.',
      'story.crew.heading': 'Meet the crew',
      'story.crew.lila.title': 'Lila Reyes - Founder',
      'story.crew.lila.copy':
        'A marine biologist turned travel designer, Lila launched Beyond the Reef to share hidden reefs and island communities with respectful explorers.',
      'story.crew.makai.title': 'Makai Thompson - Experience Architect',
      'story.crew.makai.copy':
        'Raised between three islands, Makai weaves cultural rituals, local artisans, and signature flavors into each itinerary.',
      'story.crew.sami.title': 'Sami Chen - Technology Lead',
      'story.crew.sami.copy':
        'Sami built our collaborative planning platform with real-time availability checks and concierge messaging that feels like texting a friend.',
      'story.values.heading': 'What we stand for',
      'story.values.regen.title': 'Regenerative travel',
      'story.values.regen.copy':
        'We partner with community-led conservation projects and donate a portion of every itinerary to reef restoration.',
      'story.values.hospitality.title': 'Hospitality with heart',
      'story.values.hospitality.copy':
        'Your hosts welcome you like family, preparing meaningful surprises and thoughtful touches along the way.',
      'story.values.tech.title': 'Technology that disappears',
      'story.values.tech.copy':
        'The planning tools are powerful, yet effortless, so you stay focused on excitement rather than logistics.'
    }
  },
  es: {
    global: {
      'nav.primary': 'Principal',
      'nav.toggle': 'Mostrar u ocultar la navegaci√≥n',
      'nav.home': 'Inicio',
      'nav.create': 'Excursiones',
      'nav.reviews': 'Rese√±as',
      'nav.story': 'Nuestra historia',
      'footer.rights': 'Beyond the Reef Mexico. Todos los derechos reservados.',
      'floatingContact.aria': 'Opciones de contacto r√°pido',
      'floatingContact.whatsappAria': 'Chatear en WhatsApp',
      'floatingContact.emailAria': 'Enviar correo a Beyond the Reef Mexico',
      'floatingContact.instagramAria': 'Abrir Instagram',
      'floatingContact.whatsappLabel': 'WhatsApp',
      'floatingContact.emailLabel': 'Correo',
      'floatingContact.instagramLabel': 'Instagram',
      'themeToggle.dark': 'Modo oscuro',
      'themeToggle.light': 'Modo claro',
      'heroSlider.goToSlide': 'Ir a la diapositiva {{index}}',
      'tourBuilder.remove': 'Eliminar'
    },
    home: {
      'page.title': 'Beyond the Reef Mexico',
      'home.hero.aria': 'Experiencias destacadas',
      'home.hero.heading': 'Pura adrenalina. Naturaleza ind√≥mita. Tu historia en marcha.',
      'home.hero.description':
        'No es solo una excursi√≥n: es libertad desatada. Nada con tortugas, sum√©rgete en cenotes, cruza lagunas a toda velocidad y explora antiguas ruinas mayas. Sin multitudes. Sin l√≠mites. Solo aventura pura en el coraz√≥n de la Riviera Maya. Tus reglas. Tu ritmo. Tu recuerdo inolvidable. Esto no es turismo. Esto es Beyond the Reef.',
      'home.hero.previous': 'Diapositiva anterior',
      'home.hero.next': 'Siguiente diapositiva',
      'home.hero.dots': 'Diapositivas destacadas',
      'home.difference.heading': 'Vive la diferencia',
      'home.difference.captured.title': 'Capturado',
      'home.difference.captured.copy': 'Fotograf√≠a incluida en cada tour',
      'home.difference.pace.title': 'Marca el ritmo',
      'home.difference.pace.copy': 'Elige tu horario, evita traslados y dise√±a tu propio itinerario',
      'home.difference.journey.title': 'Tu traves√≠a',
      'home.difference.journey.copy': 'Snorkel, explorar, saborear o relajarte: t√∫ decides',
      'home.difference.surprises.title': 'Sin sorpresas',
      'home.difference.surprises.copy': 'Sin costos ocultos, sin cargos extra, solo aventura',
      'home.difference.excellence.title': 'Excelencia',
      'home.difference.excellence.copy': 'No lo decimos nosotros: lo dicen nuestros hu√©spedes. Cinco estrellas siempre.',
      'home.favorites.heading': 'Aventuras que enamoran a los viajeros',
      'home.favorites.copy': 'Desliza para conocer las ofertas limitadas de los tours que m√°s enamoran a nuestros viajeros.',
      'home.favorites.previous': 'Tours anteriores',
      'home.favorites.next': 'M√°s tours',
      'home.favorites.card1.tag': 'Imprescindible',
      'home.favorites.card1.title': 'Nado con tibur√≥n ballena',
      'home.favorites.card1.badge': '-30%',
      'home.favorites.card1.deal': 'Hasta 30% de descuento',
      'home.favorites.card1.copy':
        'Alquila un barco privado con gu√≠as bi√≥logos marinos y nada junto a estos gigantes pac√≠ficos al amanecer.',
      'home.favorites.card1.cta': 'M√°s informaci√≥n',
      'home.favorites.card2.tag': 'Favorito de los hu√©spedes',
      'home.favorites.card2.title': 'El Taco Tour',
      'home.favorites.card2.badge': '-25%',
      'home.favorites.card2.deal': 'Hasta 25% de descuento',
      'home.favorites.card2.copy':
        'Saborea taquer√≠as ocultas con un anfitri√≥n local que marida mezcales y comparte leyendas callejeras.',
      'home.favorites.card2.cta': 'M√°s informaci√≥n',
      'home.favorites.card3.tag': 'Cupos limitados',
      'home.favorites.card3.title': 'Snorkel en El Cielo Cozumel',
      'home.favorites.card3.badge': '-22%',
      'home.favorites.card3.deal': 'Hasta 22% de descuento',
      'home.favorites.card3.copy':
        'Flota sobre jardines de estrellas de mar y arrecifes ne√≥n en Cozumel con un capit√°n que elige el banco de arena en su punto m√°s claro.',
      'home.favorites.card3.cta': 'M√°s informaci√≥n',
      'home.favorites.card4.tag': 'Listo para fotos',
      'home.favorites.card4.title': 'Experiencia Insta en Tulum',
      'home.favorites.card4.badge': '-18%',
      'home.favorites.card4.deal': 'Hasta 18% de descuento',
      'home.favorites.card4.copy':
        'Captura tomas cinematogr√°ficas en las ruinas y cenotes de Tulum con un director creativo preparando cada escena.',
      'home.favorites.card4.cta': 'M√°s informaci√≥n',
      'home.builder.eyebrow': 'Planifica con nuestro equipo concierge',
      'home.builder.heading': 'Creamos tu d√≠a perfecto',
      'home.builder.copy':
        'Env√≠anos tu idea y te responderemos con una cotizaci√≥n personalizada de tu d√≠a, o agenda una videollamada con nuestro equipo concierge para pulir cada detalle.',
      'home.builder.formAria': 'Env√≠a los detalles de tu d√≠a perfecto',
      'home.builder.nameLabel': 'Nombre',
      'home.builder.namePlaceholder': 'Tu nombre',
      'home.builder.emailLabel': 'Correo electr√≥nico',
      'home.builder.emailPlaceholder': 'tu@correo.com',
      'home.builder.phoneLabel': 'Tel√©fono',
      'home.builder.phonePlaceholder': '+52 1 555 555 5555',
      'home.builder.notesLabel': 'Cu√©ntanos tu idea',
      'home.builder.notesPlaceholder': 'Incluye la fecha, el ambiente y las experiencias imperdibles.',
      'home.builder.submit': 'Enviar mi idea',
      'home.builder.listHeading': 'Cu√©ntanos sobre tu d√≠a so√±ado',
      'home.builder.pointOne': 'Comparte el ambiente que buscas: relajado, con adrenalina, rom√°ntico o fuera de lo com√∫n.',
      'home.builder.pointTwo': 'Agrega actividades imprescindibles, estilo de comida o preferencias de horario.',
      'home.builder.pointThree': 'Te responderemos con una cotizaci√≥n a medida o agendaremos una videollamada con nuestro equipo concierge.',
      'home.builder.emailFallback':
        '¬øPrefieres correo? Escr√≠benos a <a href="mailto:info@beyondthereefmexico.com">info@beyondthereefmexico.com</a>.',
      'home.builder.emailSubject': 'Idea de d√≠a personalizado de {{name}}',
      'home.builder.status.missing': 'Por favor agrega tu nombre, correo e idea para crear tu cotizaci√≥n.',
      'home.builder.status.prompt': 'Abriendo tu app de correo para enviar los detalles a nuestro concierge.',
      'home.accent.eyebrow': 'Por qu√© nos aman los viajeros',
      'home.accent.heading': 'Atenci√≥n concierge VIP para la excursi√≥n inolvidable de tu familia',
      'home.accent.locals.title': 'Guiado por gu√≠as certificados',
      'home.accent.locals.copy':
        'Nuestros gu√≠as certificados tienen a√±os de experiencia profesional y organizan momentos √∫nicos que no encontrar√°s en un folleto.',
      'home.accent.collab.title': '¬øNo encuentras el tour ideal?',
      'home.accent.collab.copy':
        'Escr√≠benos y agendamos una llamada o videollamada para crear tus vacaciones perfectas a la medida.',
      'home.accent.execution.title': 'Tours sin preocupaciones',
      'home.accent.execution.copy':
        'Tu tour, tu horario, sin cargos ocultos: coordinamos traslados, boletos y tiempos para que solo disfrutes.',
      'home.cta.heading': '¬øListo para dise√±ar tu tour so√±ado?',
      'home.cta.copy': 'Escr√≠bele a nuestro equipo de concierge y te enviaremos una propuesta personalizada en 24 horas.',
      'home.cta.button': 'Escr√≠benos'
    },
    tours: {
      'page.title': 'Excursiones y Tours Privados | Beyond the Reef Mexico',
      'tours.hero.eyebrow': 'Dise√±a tu tour',
      'tours.hero.heading': 'Crea experiencias tan √∫nicas como tu grupo',
      'tours.hero.copy':
        'Arrastra actividades seleccionadas, ajusta el ritmo e invita a tus acompa√±antes a colaborar en tiempo real.',
      'tours.grid.custom.title': 'Combinaciones a medida',
      'tours.grid.custom.copy':
        'Mezcla buceo, sorpresas culinarias y caminatas remotas. Nuestro planificador inteligente coordina la log√≠stica para que solo te concentres en disfrutar.',
      'tours.grid.pacing.title': 'Ritmo inteligente',
      'tours.grid.pacing.copy':
        'Equilibramos aventuras llenas de energ√≠a con momentos de descanso para que todos recarguen energ√≠as.',
      'tours.grid.collab.title': 'Co-creaci√≥n al instante',
      'tours.grid.collab.copy':
        'Comparte un enlace privado para que tu equipo vote, comente o agregue nuevas ideas. Nuestros concierges pueden sumarse en vivo para ajustarlo.',
      'tours.steps.heading': 'C√≥mo funciona el constructor personalizado',
      'tours.steps.one.title': 'Cu√©ntanos tu sue√±o',
      'tours.steps.one.copy': 'Responde algunas preguntas o comparte un mood board. Usamos tu estilo para preseleccionar experiencias.',
      'tours.steps.two.title': 'Reinventa el plan',
      'tours.steps.two.copy':
        'Reordena actividades por d√≠a, ajusta horarios y agrega peticiones especiales como fot√≥grafos o chefs privados.',
      'tours.steps.three.title': 'Conf√≠rmalo todo',
      'tours.steps.three.copy':
        'Colabora con tu concierge para definir traslados, pagos y asistencia en destino.'
    },
    reviews: {
      'page.title': 'Rese√±as de hu√©spedes | Beyond the Reef Mexico',
      'reviews.hero.eyebrow': 'Cartas de amor de nuestros hu√©spedes',
      'reviews.hero.heading': 'Historias de viajeros que fueron m√°s all√°',
      'reviews.hero.copy':
        'Descubre c√≥mo los viajes personalizados y los detalles cuidadosos convirtieron sue√±os en escapadas sin esfuerzo.',
      'reviews.featured.heading': 'Rese√±as destacadas',
      'reviews.featured.one.title': '‚ÄúPensaron en cada detalle.‚Äù',
      'reviews.featured.one.copy':
        '‚ÄúDesde el nado nocturno con mantarrayas hasta la cena sorpresa de aniversario en un banco de arena, el equipo de Beyond the Reef super√≥ todas las expectativas. No miramos el reloj ni una sola vez.‚Äù - <strong>Cam &amp; Jordan</strong>',
      'reviews.featured.two.title': '‚ÄúPlanear fue realmente divertido.‚Äù',
      'reviews.featured.two.copy':
        '‚ÄúConstruimos el itinerario juntos durante una videollamada y ve√≠amos la disponibilidad en vivo. Su concierge consigui√≥ un gu√≠a privado para mi pap√° para que explorara a su propio ritmo.‚Äù - <strong>Riya</strong>',
      'reviews.featured.three.title': '‚ÄúNuestros amigos siguen hablando del viaje.‚Äù',
      'reviews.featured.three.copy':
        '‚ÄúEl chat del grupo no dejaba de llenarse de ideas. El planificador de Beyond the Reef mantuvo todo organizado e incluso a√±adi√≥ clases de mixolog√≠a inspiradas en nuestra lista de Spotify.‚Äù - <strong>Diego &amp; crew</strong>',
      'reviews.share.heading': 'Comparte tu experiencia',
      'reviews.share.copy':
        'Escr√≠benos a <a href="mailto:info@beyondthereefmexico.com">info@beyondthereefmexico.com</a> con los mejores momentos o etiqu√©tanos en redes con <strong>#BeyondTheReef</strong> para tener la oportunidad de aparecer.'
    },
    story: {
      'page.title': 'Nuestra historia | Beyond the Reef Mexico',
      'story.hero.eyebrow': 'Nuestra historia',
      'story.hero.heading': 'Nacimos del amor por el mar y por contar historias',
      'story.hero.copy':
        'Creemos que cada viajero merece una narrativa a la medida, creada por nuestro equipo, impulsada por la tecnolog√≠a e impregnada de hospitalidad genuina.',
      'story.crew.heading': 'Conoce a la tripulaci√≥n',
      'story.crew.lila.title': 'Lila Reyes - Fundadora',
      'story.crew.lila.copy':
        'Bi√≥loga marina convertida en dise√±adora de viajes, Lila cre√≥ Beyond the Reef para compartir arrecifes ocultos y comunidades isle√±as con exploradores respetuosos.',
      'story.crew.makai.title': 'Makai Thompson - Arquitecto de Experiencias',
      'story.crew.makai.copy':
        'Criado entre tres islas, Makai teje rituales culturales, artesanos locales y sabores distintivos en cada itinerario.',
      'story.crew.sami.title': 'Sami Chen - L√≠der de Tecnolog√≠a',
      'story.crew.sami.copy':
        'Sami desarroll√≥ nuestra plataforma colaborativa con disponibilidad en tiempo real y mensajes de concierge que se sienten como chatear con un amigo.',
      'story.values.heading': 'Nuestros valores',
      'story.values.regen.title': 'Viajes regenerativos',
      'story.values.regen.copy':
        'Nos aliamos con proyectos comunitarios de conservaci√≥n y destinamos parte de cada itinerario a la restauraci√≥n de arrecifes.',
      'story.values.hospitality.title': 'Hospitalidad con coraz√≥n',
      'story.values.hospitality.copy':
        'Tus anfitriones te reciben como familia, preparando sorpresas significativas y detalles atentos durante todo el camino.',
      'story.values.tech.title': 'Tecnolog√≠a que se difumina',
      'story.values.tech.copy':
        'Nuestras herramientas de planificaci√≥n son potentes pero sencillas, para que te enfoques en la emoci√≥n y no en la log√≠stica.'
    }
  }
};

const SUPPORTED_LANGUAGES = ['en', 'es'];

const adventureTours = [
  {
    slug: 'turtles-cenotes',
    name: 'Turtles + Cenotes',
    duration: 'Half a day ‚Ä¢ Ocean + Jungle',
    tagline: '¬∑ Sea Turtles<br>¬∑ 3 Cenotes<br>¬∑ Snack & Drinks',
    description:
      'Spend a dreamy morning in the water, starting with gentle sea turtle snorkeling and ending in three crystal-clear cenotes hidden in the jungle. Every stop feels like a postcard, with time to float, breathe, and soak it all in. It is a simple, feel-good adventure that still feels big and unforgettable.',
    includes: ['üê¢ Swim with sea turtles', 'ü§ø Snorkel in 3 cenotes', 'ü•§ Snack & drinks'],
    image:
      'https://images.pexels.com/photos/847393/pexels-photo-847393.jpeg?_gl=1*1leu1xd*_ga*NTc3NjYyMTQzLjE3NjU4MTE2NzU.*_ga_8JE65Q40S6*czE3NjU5MDM2NjEkbzMkZzEkdDE3NjU5MDM2ODckajM0JGwwJGgw',
    gallery: [
      'https://images.pexels.com/photos/847393/pexels-photo-847393.jpeg?_gl=1*1leu1xd*_ga*NTc3NjYyMTQzLjE3NjU4MTE2NzU.*_ga_8JE65Q40S6*czE3NjU5MDM2NjEkbzMkZzEkdDE3NjU5MDM2ODckajM0JGwwJGgw',
      'https://images.pexels.com/photos/32865198/pexels-photo-32865198.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/32865198/pexels-photo-32865198.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-8'
    ],
    prices: {
      1: 340,
      2: 218,
      3: 207,
      4: 184,
      5: 162,
      6: 151,
      7: 140,
      8: 129,
      9: 124,
      10: 119,
      11: 119,
      12: 119
    },
    badge: 'Top pick'
  },
  {
    slug: 'tulum-turtles-cenotes',
    name: 'Tulum Underwater',
    duration: 'Full day ‚Ä¢ Culture + Water',
    tagline: '¬∑Tulum Ruins<br>¬∑Turtle Snorkeling<br>¬∑2 Cenotes<br>¬∑Full Local Lunch',
    description:
      'Walk the stunning cliffs of Tulum with a friendly guide, then slip into the water to snorkel with turtles before cooling off in two beautiful cenotes. The day flows smoothly with plenty of photo stops, easy pacing, and a full local lunch that tastes like the Yucat√°n. It is the kind of excursion that feels both magical and effortless.',
    includes: ['üèõÔ∏è Tulum ruins tour', 'üê¢ Turtle snorkeling', 'üåä Swim in 2 cenotes', 'üåÆ Full local lunch'],
    image:
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: [
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/5992273/pexels-photo-5992273.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-6'
    ],
    prices: {
      1: 390,
      2: 268,
      3: 257,
      4: 234,
      5: 212,
      6: 201,
      7: 190,
      8: 179,
      9: 174,
      10: 169,
      11: 169,
      12: 169
    },
    badge: 'Best seller'
  },
  {
    slug: 'cenotes-express',
    name: 'Cenotes Express',
    duration: 'Half a day ‚Ä¢ Cenote circuit',
    tagline: '¬∑ 4 Cenotes<br>¬∑ Rappel down a cavern<br>¬∑ Snack & Beers',
    description:
      'Dive into four different cenotes, each one more gorgeous than the last, then rappel into a cavern chamber for a true wow moment. Between swims you will have time to recharge with a snack and a cold drink, so the day feels smooth and exciting. It is a compact adventure packed with amazing water moments.',
    includes: ['üåä Visit 4 cenotes', 'üßó Rappel down a cavern', 'üç∫ Snack & beers'],
    image:
      'https://images.pexels.com/photos/2410870/pexels-photo-2410870.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/2410870/pexels-photo-2410870.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 295,
      2: 173,
      3: 162,
      4: 140,
      5: 118,
      6: 107,
      7: 95,
      8: 84,
      9: 79,
      10: 74,
      11: 74,
      12: 74
    },
    badge: 'New route'
  },
  {
    slug: 'tulum-express',
    name: 'Tulum Express',
    duration: 'Half a day ‚Ä¢ Culture dip',
    tagline: '¬∑ Tulum Ruins<br>¬∑ Drinks & Beers<br>¬∑ (Optional) Free time in Tulum',
    description:
      'Explore the Tulum ruins with a certified guide who keeps the story easy to follow and fun to hear. You will have time for those iconic ocean views, great photos, and a relaxed walk through history. After the visit, enjoy optional free time for shopping, coffee, or a quick snack to round out a perfect half-day escape.',
    includes: ['üèõÔ∏è Tulum ruins entry', 'üçπ Drinks & beers', 'üõçÔ∏è Optional free time in Tulum'],
    image:
      'https://images.pexels.com/photos/13713189/pexels-photo-13713189.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/13713189/pexels-photo-13713189.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 290,
      2: 168,
      3: 157,
      4: 135,
      5: 113,
      6: 102,
      7: 90,
      8: 79,
      9: 74,
      10: 69,
      11: 69,
      12: 69
    },
    badge: 'Quick escape'
  },
  {
    slug: 'tacos-tour',
    name: 'Tacos Tour',
    duration: 'Evening ‚Ä¢ Flavor trail',
    tagline: '¬∑ Autentic Tacos<br>¬∑ Beers, Tequila & Mezcal<br>¬∑ Free time in Playa del Carmen',
    description:
      'Taste authentic tacos at beloved local spots, sip tequila or mezcal, and enjoy a lively night in Playa del Carmen with zero rush. Every stop is easy, flavorful, and full of local charm, with plenty of time to laugh and explore. It is a delicious evening that feels like the best kind of celebration.',
    includes: ['üåÆ Authentic tacos', 'ü•É Beers, tequila & mezcal', 'üåÜ Free time in Playa del Carmen'],
    image:
      'https://images.pexels.com/photos/4958641/pexels-photo-4958641.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/4958641/pexels-photo-4958641.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 280,
      2: 158,
      3: 147,
      4: 125,
      5: 103,
      6: 92,
      7: 80,
      8: 69,
      9: 64,
      10: 59,
      11: 59,
      12: 59
    },
    badge: 'Foodie fave'
  },
  {
    slug: 'tulum-coba',
    name: 'Tulum + Coba',
    duration: 'Full day ‚Ä¢ Ruins + Cenote',
    tagline: '¬∑Tulum Ruins<br>¬∑Coba Ruins<br>¬∑Cenote with Zipline<br>¬∑Local Buffet & Drinks',
    description:
      'Spend a full day visiting the Tulum and Coba ruins with guides who keep everything simple, clear, and engaging. You will cool off in a cenote with a zipline for extra thrills, then wrap up with a satisfying local buffet and drinks. It is an all-in-one excursion that feels epic yet easy.',
    includes: ['üèõÔ∏è Tulum ruins', 'üåø Coba ruins', 'ü™Ç Cenote with zipline', 'ü•ò Local buffet & drinks'],
    image:
      'https://images.pexels.com/photos/17179205/pexels-photo-17179205.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/17179205/pexels-photo-17179205.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 534,
      2: 300,
      3: 267,
      4: 256,
      5: 234,
      6: 212,
      7: 200,
      8: 189,
      9: 184,
      10: 179,
      11: 179,
      12: 179
    },
    badge: 'All-day adventure'
  },
  {
    slug: 'coba',
    name: 'Coba',
    duration: 'Full day ‚Ä¢ Jungle history',
    tagline: '¬∑Coba Ruins<br>¬∑Bike around the site<br>¬∑Cenote with Zipline<br>¬∑Regional Buffet & Drinks',
    description:
      'Bike through the jungle ruins of Coba with a guide who brings the history to life in simple, fun ways. After exploring, you will cool off in a cenote with a zipline and enjoy a regional buffet with drinks. It is a big, beautiful day that still feels relaxed and approachable.',
    includes: ['üåø Coba ruins', 'üö≤ Bike around the site', 'ü™Ç Cenote with zipline', 'ü•ò Regional buffet & drinks'],
    image:
      'https://images.pexels.com/photos/14902028/pexels-photo-14902028.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/14902028/pexels-photo-14902028.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 367,
      2: 234,
      3: 228,
      4: 189,
      5: 167,
      6: 156,
      7: 164,
      8: 134,
      9: 129,
      10: 124,
      11: 124,
      12: 124
    },
    badge: 'History rich'
  },
  {
    slug: 'chichen-itza',
    name: 'Chichen Itza',
    duration: 'Full day ‚Ä¢ Wonder of the World',
    tagline: '¬∑ Chichen Itza ruins<br>¬∑ Cenote with zipline<br>¬∑ Local Buffet with Drinks',
    description:
      'See Chichen Itza with a knowledgeable guide who shares the stories behind the temples in an easy, memorable way. Then take a refreshing swim in a cenote with a zipline before enjoying a regional buffet with drinks. It is a world-class excursion that feels smooth, exciting, and totally worth it.',
    includes: ['üóø Chichen Itza ruins', 'ü™Ç Cenote with zipline', 'ü•ò Local buffet with drinks'],
    image:
      'https://images.pexels.com/photos/3290068/pexels-photo-3290068.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/3290068/pexels-photo-3290068.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      2: 317,
      3: 317,
      4: 272,
      5: 239,
      6: 217,
      7: 205,
      8: 194,
      9: 189,
      10: 184,
      11: 184,
      12: 184
    },
    badge: 'UNESCO site'
  },
  {
    slug: 'coba-chichen-itza',
    name: 'Coba + Chichen Itza',
    duration: 'Full day ‚Ä¢ Two Wonders',
    tagline: '¬∑ Coba Ruins<br>¬∑ Chichen Itza ruins<br>¬∑ Cenote with zipline<br>¬∑ Local Buffet with Drinks',
    description:
      'Visit Coba deep in the jungle and Chichen Itza on the open plain in one incredible, well-paced day. Break up the adventure with a cenote zipline and a regional buffet with drinks that keeps everyone happy. It is a once-in-a-lifetime tour that feels effortless and fun.',
    includes: ['üåø Coba ruins', 'üóø Chichen Itza ruins', 'ü™Ç Cenote with zipline', 'ü•ò Local buffet with drinks'],
    image:
      'https://images.pexels.com/photos/31657162/pexels-photo-31657162.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/31657162/pexels-photo-31657162.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      2: 352,
      3: 352,
      4: 307,
      5: 274,
      6: 252,
      7: 240,
      8: 229,
      9: 224,
      10: 219,
      11: 219,
      12: 219
    },
    badge: 'Epic circuit'
  },
  {
    slug: 'holbox-express',
    name: 'Holbox Express',
    duration: 'Full day ‚Ä¢ Island hopping',
    tagline: '¬∑ Private SpeedBoat<br>¬∑ 3 Islands Hoping<br>¬∑ Golf Cart<br>¬∑ Free time on the island<br>¬∑ BeachClub Buffet with open bar',
    description:
      'Ride a private speedboat to hop between dreamy Holbox islands, relax on bright white sandbars, and enjoy time to explore at your own pace. The water is stunning, the vibe is laid-back, and the day feels like a tropical movie. A beach club buffet with open bar keeps everything easy and celebratory.',
    includes: ['üö§ Private speedboat', 'üèùÔ∏è 3-island hopping', 'üõ∫ Golf cart', 'üèñÔ∏è Free time on the island', 'üçπ Beach club buffet with open bar'],
    image:
      'https://images.pexels.com/photos/11481626/pexels-photo-11481626.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/11481626/pexels-photo-11481626.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 740,
      2: 384,
      3: 329,
      4: 273,
      5: 229,
      6: 195,
      7: 173,
      8: 151,
      9: 146,
      10: 141,
      11: 141,
      12: 141
    },
    badge: 'Island life'
  },
  {
    slug: 'dolphin-turtle',
    name: 'Dolphin + Turtle',
    duration: 'Full day ‚Ä¢ UNESCO Biosphere',
    tagline: '¬∑ Sian Kaan by Speedboat<br>¬∑ Dolphin + Turtles<br>¬∑ Bird watching<br>¬∑ Reef Snorkeling<br>¬∑ Local Buffet',
    description:
      'Cruise through the Sian Ka‚Äôan reserve by speedboat to look for dolphins, turtles, and colorful reef life in a protected paradise. Slow down for peaceful bird watching, then snorkel the reef before ending with a beachside buffet. It is a breathtaking excursion that blends wildlife, water, and pure relaxation.',
    includes: ['üö§ Sian Ka‚Äôan by speedboat', 'üê¨ Dolphins & turtles', 'ü¶ú Bird watching', 'ü§ø Reef snorkeling', 'üçΩÔ∏è Local buffet'],
    image:
      'https://images.pexels.com/photos/2922672/pexels-photo-2922672.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: ['https://images.pexels.com/photos/2922672/pexels-photo-2922672.jpeg?auto=format&fit=crop&w=1200&q=70'],
    prices: {
      1: 707,
      2: 376,
      3: 254,
      4: 210,
      5: 176,
      6: 198,
      7: 176,
      8: 165,
      9: 160,
      10: 155,
      11: 155,
      12: 155
    },
    badge: 'UNESCO reserve'
  },
  {
    slug: 'fishing-half-day',
    name: 'Fishing Half Day',
    duration: 'Half a day ‚Ä¢ Private charter',
    tagline: '¬∑ Private Boat<br>¬∑ Fishing Equipment<br>¬∑ Fresh Ceviche and fish<br>¬∑ Drinks and Beers',
    description:
      'Enjoy a private fishing charter with pro guides, calm waters, and an easy pace along the coast. You will reel in the catch, then savor fresh ceviche, fish, and cold drinks right on board. It is a simple, amazing way to spend half a day on the Caribbean.',
    includes: ['üõ•Ô∏è Private boat', 'üé£ Fishing equipment', 'üêü Fresh ceviche & fish', 'üç∫ Drinks and beers'],
    image:
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70',
    gallery: [
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70',
      'https://images.pexels.com/photos/3793366/pexels-photo-3793366.jpeg?auto=format&fit=crop&w=1200&q=70&sat=-10'
    ],
    prices: {
      1: 0,
      2: 0,
      3: 0,
      4: 0,
      5: 0,
      6: 0,
      7: 0,
      8: 0,
      9: 0,
      10: 0,
      11: 0,
      12: 0
    },
    badge: 'Private boat'
  }
];

const currencyFormatter = new Intl.NumberFormat('en-US', {
  style: 'currency',
  currency: 'USD',
  maximumFractionDigits: 0
});

function interpolate(template, replacements = {}) {
  return template.replace(/\{\{(\w+)\}\}/g, (_, key) =>
    Object.prototype.hasOwnProperty.call(replacements, key) ? String(replacements[key]) : ''
  );
}

function createLanguageManager(pageKey) {
  const LANGUAGE_STORAGE_KEY = 'preferred-language';
  const storedLanguage = localStorage.getItem(LANGUAGE_STORAGE_KEY);
  const documentLanguage = document.documentElement.lang;
  let currentLanguage = SUPPORTED_LANGUAGES.includes(storedLanguage || '')
    ? storedLanguage
    : SUPPORTED_LANGUAGES.includes(documentLanguage)
    ? documentLanguage
    : 'en';
  const listeners = new Set();

  function getTranslationValue(lang, key) {
    const languageSet = translations[lang];
    if (!languageSet) return null;

    if (languageSet.global && Object.prototype.hasOwnProperty.call(languageSet.global, key)) {
      return languageSet.global[key];
    }

    if (pageKey && languageSet[pageKey] && Object.prototype.hasOwnProperty.call(languageSet[pageKey], key)) {
      return languageSet[pageKey][key];
    }

    return null;
  }

  function translateDocument(lang) {
    const languageSet = translations[lang];
    if (!languageSet) return;

    document.documentElement.lang = lang;

    const groups = [];
    if (languageSet.global) {
      groups.push(languageSet.global);
    }
    if (pageKey && languageSet[pageKey]) {
      groups.push(languageSet[pageKey]);
    }

    groups.forEach((group) => {
      Object.entries(group).forEach(([key, value]) => {
        const elements = document.querySelectorAll(`[data-i18n="${key}"]`);
        if (!elements.length) return;

        elements.forEach((element) => {
          const attr = element.dataset.i18nAttr;
          if (attr === 'html') {
            element.innerHTML = value;
          } else if (attr) {
            element.setAttribute(attr, value);
          } else {
            element.textContent = value;
          }
        });
      });
    });
  }

  function notify(lang) {
    listeners.forEach((callback) => {
      try {
        callback(lang);
      } catch (error) {
        console.error(error);
      }
    });
  }

  function applyLanguage(lang) {
    translateDocument(lang);
    notify(lang);
  }

  return {
    init() {
      applyLanguage(currentLanguage);
    },
    getLanguage() {
      return currentLanguage;
    },
    setLanguage(lang) {
      if (!SUPPORTED_LANGUAGES.includes(lang) || lang === currentLanguage) {
        return;
      }

      currentLanguage = lang;
      localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
      applyLanguage(lang);
    },
    onChange(callback) {
      if (typeof callback !== 'function') {
        return () => {};
      }

      listeners.add(callback);
      callback(currentLanguage);
      return () => listeners.delete(callback);
    },
    translate(key, replacements = {}, lang = currentLanguage) {
      const template = getTranslationValue(lang, key);
      if (typeof template !== 'string') {
        return '';
      }

      return interpolate(template, replacements);
    }
  };
}

(function () {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');

  document.addEventListener('DOMContentLoaded', () => {
    const pageKey = document.body?.dataset.page || 'home';
    const languageManager = createLanguageManager(pageKey);
    const isToursPage = pageKey === 'tours';

    setupNavigation();
    setupLanguageToggle(languageManager);
    setupThemeToggle(prefersDark, languageManager);
    window.addEventListener('resize', scheduleNavControlWidthSync, { passive: true });
    if (isToursPage) {
      buildToursHeroSlider(adventureTours);
    }
    setupHeroSlider(languageManager);
    if (isToursPage) {
      buildToursCatalog(adventureTours);
    }
    buildFavoritesCarousel(adventureTours);
    initTourPage(adventureTours);
    setupCardCarousels();
    setupInquiryForm(languageManager);
    setCurrentYear();

    languageManager.init();
    scheduleNavControlWidthSync();
  });
})();

function setupNavigation() {
  const navToggle = document.querySelector('[data-nav-toggle]');
  const navLinks = document.querySelector('.nav__links');

  if (!navToggle || !navLinks) return;

  navToggle.addEventListener('click', () => {
    const isOpen = navLinks.classList.toggle('open');
    navToggle.setAttribute('aria-expanded', String(isOpen));
  });

  navLinks.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', () => {
      if (navLinks.classList.contains('open')) {
        navLinks.classList.remove('open');
        navToggle.setAttribute('aria-expanded', 'false');
      }
    });
  });
}

let navControlWidthSyncScheduled = false;

function syncNavControlWidths() {
  navControlWidthSyncScheduled = false;
  const controls = Array.from(document.querySelectorAll('.language-toggle, .theme-toggle'));
  if (controls.length < 2) {
    return;
  }

  controls.forEach((control) => {
    control.style.removeProperty('--nav-control-width');
  });

  const maxWidth = controls.reduce((largest, control) => {
    const { width } = control.getBoundingClientRect();
    return width > largest ? width : largest;
  }, 0);

  if (!maxWidth) {
    return;
  }

  const widthValue = `${Math.ceil(maxWidth)}px`;
  controls.forEach((control) => {
    control.style.setProperty('--nav-control-width', widthValue);
  });
}

function scheduleNavControlWidthSync() {
  if (navControlWidthSyncScheduled) {
    return;
  }

  navControlWidthSyncScheduled = true;
  const scheduler =
    typeof window.requestAnimationFrame === 'function'
      ? window.requestAnimationFrame.bind(window)
      : (callback) => window.setTimeout(callback, 16);

  scheduler(() => {
    syncNavControlWidths();
  });
}

function setupLanguageToggle(languageManager) {
  const toggle = document.querySelector('[data-language-toggle]');
  if (!toggle) return;

  const updateToggle = (lang) => {
    const isSpanish = lang === 'es';
    const nextLanguage = isSpanish ? 'en' : 'es';
    toggle.textContent = nextLanguage === 'es' ? 'Espa√±ol üá≤üáΩ' : 'English üá∫üá∏';
    toggle.setAttribute('aria-pressed', isSpanish ? 'true' : 'false');
    scheduleNavControlWidthSync();
  };

  toggle.addEventListener('click', () => {
    const nextLanguage = languageManager.getLanguage() === 'en' ? 'es' : 'en';
    languageManager.setLanguage(nextLanguage);
  });

  languageManager.onChange(updateToggle);
}

function setupThemeToggle(prefersDark, languageManager) {
  const toggle = document.querySelector('[data-theme-toggle]');
  if (!toggle) return;

  const rootElement = document.documentElement;
  const getStoredTheme = () => {
    try {
      return localStorage.getItem('preferred-theme');
    } catch (error) {
      return null;
    }
  };

  const setStoredTheme = (value) => {
    try {
      localStorage.setItem('preferred-theme', value);
    } catch (error) {
      /* ignore storage errors */
    }
  };

  const applyTheme = (isDark) => {
    rootElement.classList.toggle('dark-mode', isDark);
    if (document.body) {
      document.body.classList.toggle('dark-mode', isDark);
    }
  };

  const storedTheme = getStoredTheme();
  const shouldUseDark = storedTheme === 'dark' || (!storedTheme && prefersDark?.matches);

  applyTheme(Boolean(shouldUseDark));
  toggle.setAttribute('aria-pressed', shouldUseDark ? 'true' : 'false');

  const updateLabel = (lang) => {
    const isDark = rootElement.classList.contains('dark-mode');
    const key = isDark ? 'themeToggle.light' : 'themeToggle.dark';
    toggle.textContent = languageManager.translate(key, {}, lang);
    scheduleNavControlWidthSync();
  };

  toggle.addEventListener('click', () => {
    const nextIsDark = !rootElement.classList.contains('dark-mode');
    applyTheme(nextIsDark);
    toggle.setAttribute('aria-pressed', nextIsDark ? 'true' : 'false');
    setStoredTheme(nextIsDark ? 'dark' : 'light');
    updateLabel(languageManager.getLanguage());
  });

  prefersDark?.addEventListener?.('change', (event) => {
    if (!getStoredTheme()) {
      applyTheme(event.matches);
      toggle.setAttribute('aria-pressed', event.matches ? 'true' : 'false');
      updateLabel(languageManager.getLanguage());
    }
  });

  languageManager.onChange(updateLabel);
}

function setupHeroSlider(languageManager) {
  const slider = document.querySelector('.hero-slider');
  if (!slider) return;

  const slides = Array.from(slider.querySelectorAll('.hero-slide'));
  const dotsContainer = slider.querySelector('.hero-slider__dots');
  const prevButton = slider.querySelector('[data-slide="prev"]');
  const nextButton = slider.querySelector('[data-slide="next"]');

  if (!slides.length) return;

  let currentIndex = slides.findIndex((slide) => slide.classList.contains('is-active'));
  if (currentIndex === -1) {
    slides[0].classList.add('is-active');
    currentIndex = 0;
  }

  const HAVE_CURRENT_DATA =
    typeof HTMLMediaElement !== 'undefined' ? HTMLMediaElement.HAVE_CURRENT_DATA : 2;
  let autoRotateTimer = null;
  const DEFAULT_ROTATE_INTERVAL = 7000;
  const hasMultipleSlides = slides.length > 1;

  const ensureMediaSource = (slide, index, eager = false) => {
    const media = slide.querySelector('.hero-slide__media');
    if (!media) return null;

    if (!media.src && media.dataset?.src && (eager || slide.classList.contains('is-active'))) {
      media.src = media.dataset.src;
    }

    if (media.tagName.toLowerCase() === 'video') {
      media.preload = eager ? 'auto' : 'metadata';
    }

    return media;
  };

  const handleMediaEnded = (index) => {
    if (!hasMultipleSlides) return;
    if (currentIndex !== index) return;
    nextSlide();
  };

  slides.forEach((slide, index) => {
    const media = ensureMediaSource(slide, index, index === currentIndex);
    if (!media) return;
    const isVideo = media.tagName.toLowerCase() === 'video';
    const endOffsetSeconds = Number(media.dataset?.endOffset ?? media.dataset?.endOffsetSeconds ?? 0);

    const markLoaded = () => {
      media.classList.add('is-loaded');
    };

    if (isVideo) {
      media.loop = false;
      media.preload = index === currentIndex ? 'auto' : 'metadata';

      if (media.readyState >= HAVE_CURRENT_DATA) {
        markLoaded();
      } else {
        ['loadeddata', 'canplay'].forEach((eventName) => {
          media.addEventListener(eventName, markLoaded, { once: true });
        });
      }

      media.addEventListener('loadedmetadata', () => {
        if (index === currentIndex) {
          scheduleAutoRotate();
        }
      });

      if (Number.isFinite(endOffsetSeconds) && endOffsetSeconds > 0) {
        const handleEarlyEnd = () => {
          const { duration, currentTime } = media;
          if (!Number.isFinite(duration)) return;

          const effectiveEnd = Math.max(0, duration - endOffsetSeconds);
          if (currentTime >= effectiveEnd) {
            media.pause();
            media.removeEventListener('timeupdate', handleEarlyEnd);
            handleMediaEnded(index);
          }
        };

        media.addEventListener('timeupdate', handleEarlyEnd);
      }

      media.addEventListener(
        'error',
        () => {
          slide.classList.add('hero-slide--unavailable');
        },
        { once: true }
      );

      media.addEventListener('ended', () => handleMediaEnded(index));
    } else {
      const handleError = () => {
        markLoaded();
        slide.classList.add('hero-slide--unavailable');
      };

      if (media.complete) {
        markLoaded();
      } else {
        media.addEventListener('load', markLoaded, { once: true });
        media.addEventListener('error', handleError, { once: true });
      }
    }
  });

  function setSlideState(slide, isActive, index) {
    slide.classList.toggle('is-active', isActive);
    slide.setAttribute('aria-hidden', isActive ? 'false' : 'true');

    const video = ensureMediaSource(slide, index, isActive);
    if (!video) return;

    if (isActive) {
      if (video.preload !== 'auto') {
        video.preload = 'auto';
      }
      if (video.readyState < HAVE_CURRENT_DATA && typeof video.load === 'function') {
        video.load();
      }
      if (typeof video.play === 'function') {
        const playPromise = video.play();
        if (playPromise && typeof playPromise.catch === 'function') {
          playPromise.catch(() => {});
        }
      }
    } else {
      if (video.preload !== 'metadata') {
        video.preload = 'metadata';
      }
      if (typeof video.pause === 'function') {
        video.pause();
      }
      if (!video.loop) {
        try {
          video.currentTime = 0;
        } catch (error) {
          // Some browsers might not allow resetting the currentTime for certain sources.
        }
      }
    }
  }

  function syncSlides() {
    slides.forEach((slide, index) => {
      setSlideState(slide, index === currentIndex, index);
    });
  }

  function goToSlide(index) {
    const nextIndex = (index + slides.length) % slides.length;
    if (nextIndex === currentIndex) return;

    const previousSlide = slides[currentIndex];
    const nextSlide = slides[nextIndex];

    setSlideState(previousSlide, false, currentIndex);
    currentIndex = nextIndex;
    setSlideState(nextSlide, true, currentIndex);
    updateDots();
    restartAutoRotate();
  }

  function nextSlide() {
    goToSlide(currentIndex + 1);
  }

  function previousSlide() {
    goToSlide(currentIndex - 1);
  }

  const scheduleAutoRotate = () => {
    if (!hasMultipleSlides) return;
    stopAutoRotate();

    const activeSlide = slides[currentIndex];
    const activeVideo = ensureMediaSource(activeSlide, currentIndex, true);
    const duration = activeVideo?.duration;
    const delay = Number.isFinite(duration) && duration > 0 ? duration * 1000 : DEFAULT_ROTATE_INTERVAL;

    autoRotateTimer = window.setTimeout(nextSlide, delay);
  };

  function startAutoRotate() {
    scheduleAutoRotate();
  }

  function stopAutoRotate() {
    if (autoRotateTimer) {
      window.clearTimeout(autoRotateTimer);
      autoRotateTimer = null;
    }
  }

  function restartAutoRotate() {
    scheduleAutoRotate();
  }

  function updateDotLabels(lang = languageManager.getLanguage()) {
    if (!dotsContainer) return;
    const dots = dotsContainer.querySelectorAll('.hero-slider__dot');
    dots.forEach((dot, index) => {
      dot.setAttribute('aria-label', languageManager.translate('heroSlider.goToSlide', { index: index + 1 }, lang));
    });
  }

  function buildDots() {
    if (!dotsContainer || !hasMultipleSlides) return;

    dotsContainer.innerHTML = '';
    slides.forEach((_, index) => {
      const dot = document.createElement('button');
      dot.className = 'hero-slider__dot';
      dot.type = 'button';
      dot.setAttribute('role', 'tab');
      dot.setAttribute('aria-label', languageManager.translate('heroSlider.goToSlide', { index: index + 1 }));
      dot.addEventListener('click', () => goToSlide(index));
      dotsContainer.append(dot);
    });

    updateDots();
  }

  function updateDots() {
    if (!dotsContainer || !hasMultipleSlides) return;
    const dots = dotsContainer.querySelectorAll('.hero-slider__dot');
    dots.forEach((dot, index) => {
      dot.setAttribute('aria-selected', index === currentIndex ? 'true' : 'false');
    });
    updateDotLabels();
  }

  syncSlides();

  prevButton?.addEventListener('click', previousSlide);
  nextButton?.addEventListener('click', nextSlide);

  if (hasMultipleSlides) {
    slider.addEventListener('mouseenter', stopAutoRotate);
    slider.addEventListener('mouseleave', startAutoRotate);
    slider.addEventListener('focusin', stopAutoRotate);
    slider.addEventListener('focusout', startAutoRotate);
  }

  buildDots();
  startAutoRotate();

  languageManager.onChange(updateDotLabels);
}

function buildToursHeroSlider(tours) {
  const slider = document.querySelector('[data-tour-hero-slider]');
  const track = slider?.querySelector('[data-tour-hero-track]');
  if (!slider || !track || !tours.length) return;

  const formatTagline = (tagline = '') => tagline.replace(/<br\s*\/?>(\s*¬∑)?/gi, ' ¬∑ ').trim();

  track.innerHTML = '';

  tours.forEach((tour, index) => {
    const slide = document.createElement('article');
    slide.className = `hero-slide${index === 0 ? ' is-active' : ''}`;
    slide.setAttribute('aria-hidden', index === 0 ? 'false' : 'true');
    slide.innerHTML = `
      <a class="hero-slide__link" href="tour.html?tour=${tour.slug}">
        <img class="hero-slide__media" src="${tour.image}" alt="${tour.name} private tour" loading="lazy" />
        <div class="hero-slide__overlay">
          <h2>${tour.name}</h2>
          <span class="button button--primary hero-slide__cta">Book now</span>
        </div>
      </a>
    `;
    track.appendChild(slide);
  });
}

function createFavoriteCard(tour) {
  const halfDaySlugs = new Set(['tulum-express', 'cenotes-express', 'tacos-tour', 'turtles-cenotes']);
  const durationLabel = halfDaySlugs.has(tour.slug) ? 'Half day' : 'Full day';
  const article = document.createElement('article');
  article.className = 'card favorite-card';
  article.setAttribute('role', 'listitem');
  article.innerHTML = `
    <a class="favorite-card__media" href="tour.html?tour=${tour.slug}" aria-label="View ${tour.name}">
      <img src="${tour.image}" alt="${tour.name}" loading="lazy" />
      <span class="favorite-card__tag">${tour.badge || tour.tagline}</span>
      <span class="favorite-card__badge">${durationLabel}</span>
    </a>
    <div class="favorite-card__body">
      <h3>${tour.name}</h3>
      <p class="favorite-card__deal">${tour.tagline}</p>
      <p class="favorite-card__copy">${tour.description}</p>
      <a class="button button--primary favorite-card__cta" href="tour.html?tour=${tour.slug}">View details</a>
    </div>
  `;
  return article;
}

function createTourGridCard(tour) {
  const article = document.createElement('article');
  article.className = 'card tour-grid-card';
  article.setAttribute('role', 'listitem');
  article.innerHTML = `
    <div class="tour-grid-card__media">
      <a href="tour.html?tour=${tour.slug}" aria-label="View ${tour.name}">
        <img src="${tour.image}" alt="${tour.name}" loading="lazy" />
        <span class="tour-grid-card__badge">${tour.badge || 'Private tour'}</span>
      </a>
    </div>
    <div class="tour-grid-card__body">
      <h3 class="tour-grid-card__title">${tour.name}</h3>
      <p class="tour-grid-card__meta">${tour.duration}</p>
      <p class="tour-grid-card__copy">${tour.description}</p>
      <a class="button button--primary tour-grid-card__cta" href="tour.html?tour=${tour.slug}">Book now</a>
    </div>
  `;
  return article;
}

function populateCardTrack(selector, tours) {
  const track = document.querySelector(selector);
  if (!track) return null;
  track.innerHTML = '';
  tours.forEach((tour) => track.appendChild(createFavoriteCard(tour)));
  return track;
}

function buildToursCatalog(tours) {
  const grid = document.querySelector('[data-tour-grid]');
  if (!grid || !tours.length) return;

  grid.innerHTML = '';
  tours.forEach((tour) => grid.appendChild(createTourGridCard(tour)));
}

function buildFavoritesCarousel(tours) {
  populateCardTrack('[data-favorites-track]', tours);
}

function setupCardCarousels() {
  const carousels = document.querySelectorAll('[data-card-carousel]');
  if (!carousels.length) return;

  carousels.forEach((carousel) => {
    const viewport = carousel.querySelector('.favorites-carousel__viewport');
    const track = carousel.querySelector('.favorites-carousel__track');
    const prevButton = carousel.querySelector('[data-carousel-arrow="prev"]');
    const nextButton = carousel.querySelector('[data-carousel-arrow="next"]');

    if (!viewport || !track) return;

    const cards = Array.from(track.querySelectorAll('.favorite-card'));

    const getGap = () => {
      const styles = window.getComputedStyle(track);
      const gapValue = parseFloat(styles.columnGap || styles.gap || '0');
      return Number.isFinite(gapValue) ? gapValue : 0;
    };

    const updateArrowState = () => {
      const maxScroll = Math.max(0, viewport.scrollWidth - viewport.clientWidth);
      const atStart = viewport.scrollLeft <= 1;
      const atEnd = viewport.scrollLeft >= maxScroll - 1;

      if (prevButton) {
        prevButton.disabled = atStart;
      }
      if (nextButton) {
        nextButton.disabled = atEnd;
      }

      carousel.classList.toggle('favorites-carousel--is-scrollable', maxScroll > 1);
    };

    const scrollByDirection = (direction) => {
      const multiplier = direction < 0 ? -1 : 1;
      const cardWidth = cards.length ? cards[0].getBoundingClientRect().width : viewport.clientWidth;
      const target = viewport.scrollLeft + multiplier * (cardWidth + getGap());
      const maxScroll = viewport.scrollWidth - viewport.clientWidth;
      const clamped = Math.max(0, Math.min(target, maxScroll));
      viewport.scrollTo({ left: clamped, behavior: 'smooth' });
    };

    prevButton?.addEventListener('click', () => scrollByDirection(-1));
    nextButton?.addEventListener('click', () => scrollByDirection(1));

    let scrollRaf = null;
    const handleScroll = () => {
      if (scrollRaf) return;
      scrollRaf = window.requestAnimationFrame(() => {
        scrollRaf = null;
        updateArrowState();
      });
    };

    viewport.addEventListener('scroll', handleScroll, { passive: true });

    let resizeRaf = null;
    const handleResize = () => {
      if (resizeRaf) return;
      resizeRaf = window.requestAnimationFrame(() => {
        resizeRaf = null;
        updateArrowState();
      });
    };

    window.addEventListener('resize', handleResize);

    updateArrowState();
  });
}

function setupTourGallery(gallery) {
  if (!gallery) return;

  const track = gallery.querySelector('[data-tour-gallery-track]');
  const prevButton = gallery.querySelector('[data-gallery-arrow="prev"]');
  const nextButton = gallery.querySelector('[data-gallery-arrow="next"]');
  const slides = track ? Array.from(track.children) : [];
  let current = 0;

  const update = () => {
    if (!track) return;
    track.style.transform = `translate3d(-${current * 100}%, 0, 0)`;
    const disableArrows = slides.length <= 1;
    if (prevButton) prevButton.disabled = disableArrows;
    if (nextButton) nextButton.disabled = disableArrows;
  };

  const goTo = (direction) => {
    if (!slides.length) return;
    current = (current + direction + slides.length) % slides.length;
    update();
  };

  prevButton?.addEventListener('click', () => goTo(-1));
  nextButton?.addEventListener('click', () => goTo(1));

  update();
}

function initTourPage(tours) {
  const tourPage = document.querySelector('[data-tour-page]');
  if (!tourPage || !tours.length) return;

  const params = new URLSearchParams(window.location.search);
  const slug = params.get('tour');
  const tour = tours.find((item) => item.slug === slug) || tours[0];
  if (!tour) return;

  const galleryTrack = document.querySelector('[data-tour-gallery-track]');
  const galleryWrapper = document.querySelector('[data-tour-gallery]');
  const titleEl = document.querySelector('[data-tour-title]');
  const durationEl = document.querySelector('[data-tour-duration]');
  const taglineEl = document.querySelector('[data-tour-tagline]');
  const descriptionEl = document.querySelector('[data-tour-description]');
  const includesEl = document.querySelector('[data-tour-includes]');
  const priceEl = document.querySelector('[data-tour-price]');
  const guestSelect = document.querySelector('[data-tour-guests]');
  const bookingForm = document.querySelector('[data-tour-booking]');
  const noteEl = bookingForm?.querySelector('.tour-booking__note');
  const nameInput = document.querySelector('[data-tour-name]');
  const emailInput = document.querySelector('[data-tour-email]');
  const phoneInput = document.querySelector('[data-tour-phone]');
  const dateTimeInput = document.querySelector('[data-tour-datetime]');
  const dateTimeUnknown = document.querySelector('[data-tour-datetime-unknown]');
  const dateTimeField = document.querySelector('[data-tour-datetime-field]');
  const formspreeEndpoint = 'https://formspree.io/f/REPLACE_ME';

  if (titleEl) titleEl.textContent = tour.name;
  if (durationEl) durationEl.textContent = tour.duration;
  if (taglineEl) taglineEl.textContent = tour.tagline;
  if (descriptionEl) descriptionEl.textContent = tour.description;
  document.title = `${tour.name} | Beyond the Reef Mexico`;

  if (includesEl) {
    includesEl.innerHTML = '';
    tour.includes.forEach((item) => {
      const cleanItem = item.replace(/^¬∑\s*/, '');
      const li = document.createElement('li');
      li.textContent = cleanItem;
      includesEl.appendChild(li);
    });
  }

  if (galleryTrack) {
    galleryTrack.innerHTML = '';
    const images = tour.gallery && tour.gallery.length ? tour.gallery : [tour.image];
    images.forEach((src, index) => {
      const slide = document.createElement('figure');
      slide.className = 'tour-gallery__slide';
      slide.innerHTML = `<img src="${src}" alt="${tour.name} photo ${index + 1}" loading="lazy" />`;
      galleryTrack.appendChild(slide);
    });
  }

  setupTourGallery(galleryWrapper);

  const buildGuestOptions = () => {
    if (!guestSelect) return;
    if (!tour.prices) return;

    const counts = Object.keys(tour.prices)
      .map((value) => Number(value))
      .filter((value) => Number.isFinite(value))
      .sort((a, b) => a - b);

    if (!counts.length) return;

    guestSelect.innerHTML = '';
    counts.forEach((count) => {
      const option = document.createElement('option');
      option.value = String(count);
      option.textContent = String(count);
      guestSelect.appendChild(option);
    });

    const defaultCount = counts.includes(2) ? 2 : counts[0];
    guestSelect.value = String(defaultCount);
  };

  buildGuestOptions();

  const updatePrice = () => {
    if (!priceEl || !guestSelect) return;
    const guests = Number(guestSelect.value) || 1;
    const price = tour.prices ? tour.prices[guests] : tour.basePrice;
    priceEl.textContent = currencyFormatter.format(price || 0);
  };

  guestSelect?.addEventListener('change', updatePrice);
  updatePrice();

  const toggleDateTime = () => {
    if (!dateTimeInput || !dateTimeUnknown) return;
    const isUnknown = dateTimeUnknown.checked;
    dateTimeInput.disabled = isUnknown;
    if (isUnknown) {
      dateTimeInput.value = '';
    }
  };

  dateTimeUnknown?.addEventListener('change', toggleDateTime);
  toggleDateTime();

  const openDateTimePicker = () => {
    if (!dateTimeInput || dateTimeInput.disabled) return;
    if (typeof dateTimeInput.showPicker === 'function') {
      dateTimeInput.showPicker();
    }
  };

  dateTimeInput?.addEventListener('click', openDateTimePicker);
  dateTimeInput?.addEventListener('focus', openDateTimePicker);
  dateTimeField?.addEventListener('click', (event) => {
    if (event.target instanceof HTMLInputElement && event.target.type === 'checkbox') return;
    openDateTimePicker();
    dateTimeInput?.focus();
  });

  bookingForm?.addEventListener('submit', (event) => {
    event.preventDefault();
    const guests = Number(guestSelect?.value) || 1;
    const pickup = (document.querySelector('[data-tour-pickup]')?.value || 'your location').trim();
    const name = (nameInput?.value || '').trim();
    const email = (emailInput?.value || '').trim();
    const phone = (phoneInput?.value || '').trim();
    const dateTimeValue = (dateTimeInput?.value || '').trim();
    const dateTimeLabel = dateTimeUnknown?.checked ? 'Not sure yet' : dateTimeValue || 'Not provided';
    if (noteEl) {
      noteEl.textContent = `Holding ${guests} spot(s) for ${tour.name}. We will confirm pick-up at ${pickup} right away.`;
    }
    if (!formspreeEndpoint || formspreeEndpoint.includes('REPLACE_ME')) {
      if (noteEl) {
        noteEl.textContent = 'Please connect the booking form to your email service to receive requests.';
      }
      return;
    }
    const payload = {
      tour: tour.name,
      guests,
      name: name || 'Not provided',
      email: email || 'Not provided',
      phone: phone || 'Not provided',
      dateTime: dateTimeLabel,
      pickup
    };
    fetch(formspreeEndpoint, {
      method: 'POST',
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    })
      .then((response) => {
        if (!noteEl) return;
        noteEl.textContent = response.ok
          ? 'Request sent! We will confirm availability and follow up right away.'
          : 'Something went wrong sending your request. Please try again shortly.';
      })
      .catch(() => {
        if (noteEl) {
          noteEl.textContent = 'Unable to send your request right now. Please try again shortly.';
        }
      });
  });

  const relatedTours = tours.filter((item) => item.slug !== tour.slug);
  populateCardTrack('[data-related-track]', relatedTours);
}

function setupInquiryForm(languageManager) {
  const form = document.querySelector('#custom-contact-form');
  const status = document.querySelector('#custom-contact-status');

  if (!form) return;

  const setStatus = (message = '', isError = false) => {
    if (!status) return;
    status.textContent = message;
    status.classList.toggle('is-error', Boolean(isError));
  };

  const buildMailtoBody = (name, email, phone, idea) => {
    const lines = [`Name: ${name}`, `Email: ${email}`];
    if (phone) {
      lines.push(`Phone: ${phone}`);
    }
    lines.push('', 'Trip idea:', idea);
    return encodeURIComponent(lines.join('\n'));
  };

  form.addEventListener('submit', (event) => {
    event.preventDefault();
    const formData = new FormData(form);
    const name = (formData.get('name') || '').toString().trim();
    const email = (formData.get('email') || '').toString().trim();
    const phone = (formData.get('phone') || '').toString().trim();
    const idea = (formData.get('idea') || '').toString().trim();

    if (!name || !email || !idea) {
      setStatus(languageManager.translate('home.builder.status.missing'), true);
      return;
    }

    const subject = encodeURIComponent(languageManager.translate('home.builder.emailSubject', { name }));
    const body = buildMailtoBody(name, email, phone, idea);
    const mailtoLink = `mailto:info@beyondthereefmexico.com?subject=${subject}&body=${body}`;

    setStatus(languageManager.translate('home.builder.status.prompt'));
    window.location.href = mailtoLink;
    form.reset();
  });

  languageManager.onChange(() => setStatus(''));
}

function setCurrentYear() {
  const year = document.querySelector('#current-year');
  if (year) {
    year.textContent = new Date().getFullYear();
  }
}
